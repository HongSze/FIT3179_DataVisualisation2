{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": { 
    "text": "Annual Min & Max Air Pollutant Index (1998–2020)",
    "fontSize": 14,
    "anchor": "middle"               
  },
  "autosize": {"type": "fit", "contains": "padding", "resize": true},
  "data": {"url": "../Dataset/1998 2020 Annual Maximum and Minimum Air Pollutant.csv", "format": {"type": "csv"}},
  "config": {"view": {"stroke": null}},
  "transform": [
    {"calculate": "trim(datum['Selected Stations'])", "as": "station"},
    {"calculate": "toNumber(datum.Maximum)", "as": "max_v"},
    {"calculate": "toNumber(datum.Minimum)", "as": "min_v"},
    {"filter": "isValid(datum.max_v) && isValid(datum.min_v)"},
    {"calculate": "datum.max_v - datum.min_v", "as": "range_v"}
  ],

  "vconcat": [
    {
      "hconcat": [
        {
          "width": 145, "height": 75,
          "title": { "text": "Bandaraya Melaka, Melaka", "fontSize": 12, "offset": 4 },
          "transform": [{"filter": "datum.station === 'Bandaraya Melaka, Melaka'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API"},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative"},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max−Min)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 145, "height": 75,
          "title": { "text": "Cheras, Kuala Lumpur", "fontSize": 12, "offset": 4 },
          "transform": [{"filter": "datum.station === 'Cheras, Kuala Lumpur'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API"},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative"},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max−Min)", "format": ".1f"}
                ]
              }
            }
          ]
        }
      ]
    },

    {
      "hconcat": [
        {
          "width": 145, "height": 75,
          "title": { "text": "Kota Kinabalu, Sabah", "fontSize": 12, "offset": 4 },
          "transform": [{"filter": "datum.station === 'Kota Kinabalu, Sabah'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API"},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative"},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max−Min)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 145, "height": 75,
          "title": { "text": "Kuching, Sarawak", "fontSize": 12, "offset": 4 },
          "transform": [{"filter": "datum.station === 'Kuching, Sarawak'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API"},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative"},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max−Min)", "format": ".1f"}
                ]
              }
            }
          ]
        }
      ]
    },

    {
      "hconcat": [
        {
          "width": 145, "height": 75,
          "title": { "text": "Larkin, Johor Bahru", "fontSize": 12, "offset": 4 },
          "transform": [{"filter": "datum.station === 'Larkin, Johor Bahru'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API"},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative"},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max−Min)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 145, "height": 75,
          "title": { "text": "Miri, Sarawak", "fontSize": 12, "offset": 4 },
          "transform": [{"filter": "datum.station === 'Miri, Sarawak'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API"},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative"},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max−Min)", "format": ".1f"}
                ]
              }
            }
          ]
        }
      ]
    },

    {
      "hconcat": [
        {
          "width": 145, "height": 75,
          "title": { "text": "Seberang Jaya, Pulau Pinang", "fontSize": 12, "offset": 4 },
          "transform": [{"filter": "datum.station === 'Seberang Jaya, Pulau Pinang'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API"},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative"},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max−Min)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 14, "height": 75,
          "data": {"values": [{}]},
          "mark": {"type": "rect", "opacity": 0},
          "title": "" 
        }
      ]
    }
  ]
}

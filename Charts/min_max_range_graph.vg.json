{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": { 
    "text": "Annual min & max Air Pollutant Index",
    "fontSize": 15.5,
    "anchor": "middle"
  },
  "background": "#d5e6eb",
  "autosize": {"type": "fit", "contains": "padding", "resize": true},
  "data": {
    "url": "https://raw.githubusercontent.com/HongSze/FIT3179_DataVisualisation2/refs/heads/main/Dataset/1998%202020%20Annual%20Maximum%20and%20Minimum%20Air%20Pollutant.csv",
    "format": {"type": "csv"}
  },
  "config": {
    "view": { "stroke": null },
    "area": { "fill": "#E6D9FF", "opacity": 1, "stroke": "#170b56", "strokeWidth": 1 },
    "rule": { "color": "#120942" }
  },
  "transform": [
    {"calculate": "trim(datum['Selected Stations'])", "as": "station"},
    {"calculate": "toNumber(datum.Maximum)", "as": "max_v"},
    {"calculate": "toNumber(datum.Minimum)", "as": "min_v"},
    {"filter": "isValid(datum.max_v) && isValid(datum.min_v)"},
    {"calculate": "datum.max_v - datum.min_v", "as": "range_v"}
  ],
  "vconcat": [
    {
      "hconcat": [
        {
          "width": 120, "height": 70,
          "title": {"text": "Bandaraya Melaka, Melaka", "fontSize": 12, "offset": 4},
          "transform": [{"filter": "datum.station === 'Bandaraya Melaka, Melaka'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max‚àíMin)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 120, "height": 70,
          "title": {"text": "Cheras, Kuala Lumpur", "fontSize": 12, "offset": 4},
          "transform": [{"filter": "datum.station === 'Cheras, Kuala Lumpur'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max‚àíMin)", "format": ".1f"}
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "hconcat": [
        {
          "width": 120, "height": 70,
          "title": {"text": "Kota Kinabalu, Sabah", "fontSize": 12, "offset": 4},
          "transform": [{"filter": "datum.station === 'Kota Kinabalu, Sabah'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max‚àíMin)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 120, "height": 70,
          "title": {"text": "Kuching, Sarawak", "fontSize": 12, "offset": 4},
          "transform": [{"filter": "datum.station === 'Kuching, Sarawak'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max‚àíMin)", "format": ".1f"}
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "hconcat": [
        {
          "width": 120, "height": 70,
          "title": {"text": "Larkin, Johor Bahru", "fontSize": 12, "offset": 4},
          "transform": [{"filter": "datum.station === 'Larkin, Johor Bahru'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max‚àíMin)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 120, "height": 70,
          "title": {"text": "Miri, Sarawak", "fontSize": 12, "offset": 4},
          "transform": [{"filter": "datum.station === 'Miri, Sarawak'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max‚àíMin)", "format": ".1f"}
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "hconcat": [
        {
          "width": 120, "height": 70,
          "title": {"text": "Seberang Jaya, Pulau Pinang", "fontSize": 12, "offset": 4},
          "transform": [{"filter": "datum.station === 'Seberang Jaya, Pulau Pinang'"}],
          "layer": [
            {
              "mark": {"type": "area", "opacity": 0.25},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year"},
                "y": {"field": "min_v", "type": "quantitative", "title": "API", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"}
              }
            },
            {
              "mark": {"type": "rule", "strokeWidth": 1},
              "encoding": {
                "x": {"field": "Year", "type": "temporal", "timeUnit": "year"},
                "y": {"field": "min_v", "type": "quantitative", "scale": {"domain": [0, 600]}},
                "y2": {"field": "max_v"},
                "tooltip": [
                  {"field": "station", "title": "Station"},
                  {"field": "Year", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
                  {"field": "min_v", "type": "quantitative", "title": "Min API"},
                  {"field": "max_v", "type": "quantitative", "title": "Max API"},
                  {"field": "range_v", "type": "quantitative", "title": "Range (Max‚àíMin)", "format": ".1f"}
                ]
              }
            }
          ]
        },
        {
          "width": 120,
          "height": 70,
          "data": { "values": [
            { "note": "ùó†ùó∂ùóøùó∂ ùê¨ùê©ùê¢ùê§ùêûùê¨ set chart \nùê¨ùêúùêöùê•ùêû, while most stations \nstay ùóØùó≤ùóπùóºùòÑ ùüÆùü¨ùü¨." }
          ]},
          "mark": {
            "type": "text",
            "align": "center",
            "baseline": "middle",
            "fontSize": 13,
            "font": "Arial, sans-serif",
            "lineHeight": 15,  
            "color": "#333333",
            "lineBreak": "\n"
          },
          "encoding": {
            "x": { "value": 60 },
            "y": { "value": 15 },
            "text": { "field": "note" }
          },
          "title": ""
        }
      ]
    }
  ],
  "resolve": { "scale": { "y": "shared" } }
}
